<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Highlight.js Tokyo Night (dark) from jsDelivr / highlight.js CDN -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/tokyo-night-dark.min.css">


    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SLLMJ5YC4K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SLLMJ5YC4K');
</script>

  </head>

  <body class="bg-slate-50 text-base-content min-h-screen p-6">
    <div class="flex justify-between items-center w-full">
  <a href="http://localhost:4000" class="flex-1">
    <img class="w-12 h-12 rounded-full" src="/assets/images/headshot.jpg" />
  </a>

  <div class="hidden sm:flex w-fit justify-center items-center bg-slate-200 p-2 rounded-full font-semibold">
    <a href="/" class="hover:bg-slate-300 py-2 px-4 rounded-full">Home</a>
    <a href="https://drive.google.com/file/d/10v_i5GDWsbjHuOF4qq_nvTrEcAoZPUfY/view?usp=sharing" target="_blank" class="hover:bg-slate-300 py-2 px-4 rounded-full">Resume</a>
    <a href="javascript:window.location.href='mailto:' + atob('c3BlbmNlcmxsb3lkZGl4b25AZ21haWwuY29t')" class="hover:bg-slate-300 py-2 px-4 rounded-full">Contact</a>
  </div>

  <div class="hidden sm:flex gap-4 flex-1 justify-end">
    <a href="javascript:window.location.href='mailto:' + atob('c3BlbmNlcmxsb3lkZGl4b25AZ21haWwuY29t')">
      <i class="fa-solid fa-xl fa-envelope"></i>
    </a>


    <a href="http://localhost:4000/feed.xml">
      <i class="fa-solid fa-xl fa-rss"></i>
    </a>
  </div>

  <label class="block sm:hidden relative z-40 cursor-pointer px-3 py-6 flex-1 flex justify-end" for="mobile-menu">
    <input class="peer hidden" type="checkbox" id="mobile-menu" />
    <div
        class="relative z-50 block h-[2px] w-7 bg-black bg-transparent content-[''] before:absolute before:top-[-0.35rem] before:z-50 before:block before:h-full before:w-full before:bg-black before:transition-all before:duration-200 before:ease-out before:content-[''] after:absolute after:right-0 after:bottom-[-0.35rem] after:block after:h-full after:w-full after:bg-black after:transition-all after:duration-200 after:ease-out after:content-[''] peer-checked:bg-transparent before:peer-checked:top-0 before:peer-checked:w-full before:peer-checked:rotate-45 before:peer-checked:transform after:peer-checked:bottom-0 after:peer-checked:w-full after:peer-checked:-rotate-45 after:peer-checked:transform"
        >
    </div>
      <div
          class="fixed inset-0 z-40 hidden h-full w-full bg-black/50 backdrop-blur-sm peer-checked:block"
          >
          &nbsp;
      </div>
        <div
            class="fixed top-0 right-0 z-40 h-full w-full translate-x-full overflow-y-auto overscroll-y-none transition duration-500 peer-checked:translate-x-0"
            >
            <div class="float-right min-h-full w-[80%] bg-slate-50 px-8 pt-24 shadow-2xl">
              <menu class="flex flex-col gap-4 text-xl">
                <li><a href="/" class="flex rounded-full py-2 px-6 hover:bg-slate-200">Home</a></li>
                <li><a href="https://drive.google.com/file/d/10v_i5GDWsbjHuOF4qq_nvTrEcAoZPUfY/view?usp=sharing" target="_blank" class="flex rounded-full py-2 px-6 hover:bg-slate-200">Resume</a></li>
                <li><a href="javascript:window.location.href='mailto:' + atob('c3BlbmNlcmxsb3lkZGl4b25AZ21haWwuY29t')" class="flex rounded-full py-2 px-6 hover:bg-slate-200">Contact</a></li>
              </menu>
            </div>
        </div>
  </label>
</div>


    <main class="container mx-auto">
      <div class="max-w-screen-md mx-auto mt-24">
  <div class="flex flex-col gap-2 sm:mt-12 mb-12">
    <h1 class="text-6xl text-primary tracking-tight mb-4">Progressive Web Apps with Rails</h1>
    <time class="">10 Jun 2024</time>
  </div>

  <article class="mx-auto prose lg:prose-xl text-base-content">
    <p>Rails 8 will ship with the files necessary to make your application a Progressive Web App (PWA) by default.</p>

<p>As a Rails developer, I‚Äôm a big fan of PWAs. The idea of offering a ‚Äúgood enough‚Äù mobile app experience from the same codebase is a huge advantage for small teams and solo developers who don‚Äôt have the luxury of the time or money needed to maintain a dedicated mobile app codebase.</p>

<p>The good news is that converting your app to a PWA isn‚Äôt hard. You can do it in about 10-15 minutes. Adding native notifications and offline mode might take you a bit longer, but getting your app to be downloadable to a home screen and function like a mobile app is fairly straightforward.</p>

<p>We can take a look at the <a href="https://github.com/rails/rails/pull/50528/files">PR</a> for PWA default files in Rails 8 and take inspiration from this to make our Rails &lt;8 apps PWA ready.</p>

<h1 id="1-add-the-metatags-to-your-layout">1. Add the metatags to your layout</h1>

<pre><code class="language-html">&lt;head&gt;
  &lt;meta name="apple-mobile-web-app-capable" content="yes"&gt;
  &lt;link rel="manifest" href="/manifest.json"&gt;
&lt;/head&gt;
</code></pre>

<p>The MVP for a PWA is to serve a <code>manifest.json</code> at the root path of your project. This file contains the config for your PWA, details like the name that should be used for the app, the app icon, a description etc.</p>

<h1 id="2-add-a-pwa-controller-to-serve-the-manifestjson">2. Add a PWA controller to serve the manifest.json</h1>

<pre><code class="language-ruby">class PwaController &lt; ApplicationController
  protect_from_forgery except: :service_worker

  def service_worker
  end

  def manifest
  end
end
</code></pre>

<p><code>service_worker.js</code> can be thought of as our bridge between our PWA mobile app and our web app. It‚Äôs capable of doing things like intercepting requests and it‚Äôs where we‚Äôd do things like offline mode should we wish to. It isn‚Äôt strictly needed for transforming our Rails app into a very basic PWA, but we‚Äôll deliver an empty file for now so it‚Äôs there to expand on later.</p>

<h1 id="3-hook-up-the-routes-for-the-pwa-controller">3. Hook up the routes for the PWA controller</h1>

<p>In our <code>config/routes.rb</code></p>

<pre><code class="language-ruby">get "/service-worker.js" =&gt; "pwa#service_worker"
get "/manifest.json" =&gt; "pwa#manifest"
</code></pre>

<h1 id="4-serve-our-default-pwa-files">4. Serve our default PWA files</h1>

<p>Create a new directory at <code>app/views/pwa</code></p>

<p>We‚Äôll add an empty <code>service_worker.js</code> here, and then add another file called <code>manifest.json.erb</code>.</p>

<p>Copy in the following. Note that since we used the <code>.json.erb</code> extension, we can use the <code>image_path</code> helper here to pull a 192x192 and 512x512 icon image into the json file. These two image sizes are the bare minimum you need to serve a PWA so make sure your images conform to these sizes and that you have both in the root of your <code>assets/images</code> directory.</p>

<p>I‚Äôve found <a href="https://realfavicongenerator.net/">this site</a> helpful for creating these app icons. You can upload a high res icon and get back a zip file of icons in the right sizes and formats.</p>

<pre><code class="language-json">{
  "short_name": "Soju",
  "name": "Soju",
  "id": "/",
  "icons": [
    {
      "src": "&lt;%= image_path 'android-chrome-192x192.png' %&gt;",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "&lt;%= image_path 'android-chrome-512x512.png' %&gt;",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "start_url": "/",
  "background_color": "#fafafa",
  "display": "standalone",
  "scope": "/",
  "theme_color": "#fafafa"
}
</code></pre>

<p>That‚Äôs all there is to making your app a very basic PWA!</p>

<p>Commit and host it and you should be able to ‚ÄúAdd to Home Screen‚Äù when viewing the website in Safari on iOS. The app will save to your home screen, functioning just the same as a mobile app.</p>

<p>It‚Äôs a great solution for providing the mobile experience without the overhead of maintaining a dedicated mobile codebase.</p>


  </article>

  <div role="alert" class="mt-24 mb-12 alert alert-error alert-dash alert-vertical sm:alert-horizontal">
  üëç
  <div>
    <h3 class="font-bold">Thanks for reading</h3>
    <p class="">You can follow me here for my latest thoughts and projects</p>
  </div>
  <div class="flex items-center gap-4">
    <a href="https://github.com/spencerldixon" target="_blank">
      <i class="fa-brands fa-github fa-xl"></i>
    </a>

    <a href="https://twitter.com/spencerldixon" target="_blank">
      <i class="fa-brands fa-x-twitter fa-xl"></i>
    </a>

    <a href="https://linkedin.com/in/spencerldixon" target="_blank">
      <i class="fa-brands fa-linkedin fa-xl"></i>
    </a>

    <a href="javascript:window.location.href='mailto:' + atob('c3BlbmNlcmxsb3lkZGl4b25AZ21haWwuY29t')">
      <i class="fa-solid fa-envelope fa-xl"></i>
    </a>

    <a href="http://localhost:4000/feed.xml">
      <i class="fa-solid fa-rss fa-xl"></i>
    </a>
  </div>
</div>




</div>

    </main>

    <!-- Highlight.js core -->
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"></script>
    <script>
    // Auto-detect & highlight all <pre><code class="language-..."> blocks
    document.addEventListener("DOMContentLoaded", (event) => {
      if (window.hljs) { hljs.highlightAll(); }
    });
    </script>
  </body>
</html>
